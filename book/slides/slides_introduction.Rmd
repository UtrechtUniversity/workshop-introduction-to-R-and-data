---
title: "Welcome to Introduction to R & Data!"
author: "All course materials at [tinyurl.com/introRDatasite](https://utrechtuniversity.github.io/workshop-introduction-to-R-and-data/)"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts, 'custom.css']
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: ""
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r share-again, echo=FALSE}
xaringanExtra::use_share_again()
```

```{r style-share-again, echo=FALSE}
xaringanExtra::style_share_again(
  share_buttons = c("twitter", "linkedin")
)
```

# Welcome! Who are you?

- What part of your education are you in? (Bachelor, PhD, prof…)

- What is your faculty/background? (Economics, Medicine, Biology…)

- What is your motivation for learning R?

- What is your experience with R?

---

# This morning's schedule

- &nbsp; 9:30 &nbsp; Introductions

- 10:00 &nbsp; Base R + Exercises 1- 6

- 11:25 &nbsp; Recap & questions

- 11:30 &nbsp; Coffee break

- 11:45 &nbsp; Programming + Exercises 7-9

- 12:45 &nbsp; Lunch break

- 13:30 &nbsp; Reconvene for afternoon program

---
class: subheader, middle, center
# Introduction to R & Data

### Part 1: Basics of R
---
# What is R?

.left-column[
![rlogo](images/rlogo.png)]

.right-column[

- A widely used programming language for data analysis

- Based on statistical programming language S (1976)

- Developed by **R**oss Ihaka & **R**obert Gentleman (1995)

- Very active community, with many (often subject-specific) packages

- Open source, and interoperable!

]
---
# We will work in Rstudio

![rstudiologo](images/rstudiologo.png)

- **I**ntegrated **D**evelopment **E**nvironment (IDE) for R

- Founded by J.J. Allaire, available since 2010

- Bloody useful! Let’s take a look: please open RStudio!

---
# The Rstudio interface



![rstudio-incremental](images/rstudio-incremental-5.png)
---

# Course materials

#### All course materials, videos, information & resources are at  [tinyurl.com/introRDatasite](https://utrechtuniversity.github.io/workshop-introduction-to-R-and-data/). 

1. Download the [course materials](https://github.com/UtrechtUniversity/workshop-introduction-to-R-and-data/raw/main/course-materials.zip).

2. Store them in a local (i.e. not on a mounted drive), accessible location.

3. Unzip the download to create a single folder. **What animal is displayed on `animal.png`?**

4. Double-click the **course-materials.Rproj** file.
        Or: Go to File > Open Project > select course-materials.Rproj > Open

5. From the ‘Files’ menu (bottom right), click **baseR_exercises.Rmd**.

---

# Running R code

#### In the **baseR_exercises.Rmd**:

You can execute _Exercise 0_ chunk as a whole with the green triangle:

![run-chunk](images/run-chunk.png)

#### In a script/Rmarkdown document
- Place your cursor in the line of code you want to execute

- Press ![run](images/run.png) or ctrl + enter

- When running multiple lines: select all lines, then press ‘Run’ or ctrl + enter

---
class: subheader, middle, center
# R syntax & data types

---
# Variable assignment

.pull-left[
You can assign both numbers and text to a variable:

```{r}
x <- 6
x <- 'apple'
x <- "hello world"
```

You will see your variabe (R object) appear in your Environment (top right panel).
]

.pull-right-center[

![cheatsheet](images/baseRcheatsheet.png) 
See the `cheatsheets` folder. Or [download it](https://github.com/rstudio/cheatsheets/blob/main/base-r.pdf).
]

---
# Do you expect an answer?

Saving information as an R object:
```{r}
x <- 1
```
Asking for information to be returned:
```{r}
x
```

Note the difference in syntax: 

- `<-` operator: storing information = no immediate 'answer'
- calling up an object, or making calculations: R shows you the answer

---
# Maths functions

You can perform math with your variables:
```{r}
x * 3
```
and store the results as new variables:
```{r}
y <- x + 2

log2(y)
```

Check **"Maths Functions"** on the Base R cheatsheet:
![assignment-math](images/mathsfunctions.png)

---
# Logicals

A logical is `TRUE` or `FALSE`, and can also be written as `T` or `F`.

Logicals are mostly used as tests:

| | | |
|---|---|---|
| == | `==`  |is equal to |
| != | `!=` | is not |
| >= | `>=` | larger than or equal to |
| < | `<`  | smaller than |

For example:
```{r}
x == 6
x != 10
```
---
class: subheader, middle, center
# Go to exercise 1 in baseR_exercises.Rmd

---
# Answers to exercise 1

1. Do the following calculation in R: _1 plus 5, divided by 9_
    ```{r}
    (1+5)/9
    ```
--

2. Assign the result of the calculation to a variable.
    ```{r}
    x <- (1+5)/9
    ```
--

3. Test if the result is larger than 1.
    ```{r}
    x > 1
    ```
--

4. Round off the result to 1 decimal.
    ```{r}
    round(x,1)
    ```


---
class: subheader, middle, center
# Vectors in R

---
# Combining data: creating vectors
#### Vectors are created with the function `c()`

A numeric vector:
```{r}
c(1,2,3)
```

--

A character vector:
```{r}
c("a","b","c")
```

--

A logical vector:
```{r}
c(T,TRUE,F)
```

---
# Combining data: creating vectors

What is this vector?
```{r}
c(TRUE,"a",3)
```

--

#### Yep, a character vector!
Vector type defaults to the "lowest common denominator": everything can be a character, but not everything can be a number or a logical.

--

Order:

1. Character
2. Numeric
3. Logical

---
# Vector functions
#### Vectors can be used in mathematical operations
.pull-left-medium[
```{r}
p <- 1:5
p
mean(p)
p * 2
```
]

.pull-right-medium[
| &nbsp; &nbsp; p &nbsp; &nbsp;  | &nbsp; &nbsp; 2&nbsp; &nbsp;  | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |
|:---:|:---:|:---:|
| 1 | 2 | 2 |
| 2 | 2 | 4 |
| 3 | 2 | 6 |
| 4 | 2 | 8 |
| 5 | 2 | 10 |
]
---
# Vector functions
#### Operations with multiple vectors are performed by aligning the index
.pull-left-medium[<br />
```{r}
q <- 5:1
q
p * q
```
]

.pull-right-medium[<br />

| &nbsp; &nbsp; p &nbsp; &nbsp;  | &nbsp; &nbsp;q &nbsp; &nbsp;  | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |
|:---:|:---:|:---:|
| 1 | 5 | 5 |
| 2 | 4 | 8 |
| 3 | 3 | 9 |
| 4 | 2 | 8 |
| 5 | 1 | 5 |
]

---
class: subheader, middle, center
# Go to exercise 2

---
# Answers to exercise 2

1. _Meet Ann, Bob, Chloe, and Dan._ 
Create a character vector called "name" and add these names to the vector using the `c()` function.
    ```{r}
    name <- c("Ann", "Bob", "Chloe", "Dan")
    ```
--

2. _How old are Ann, Bob, Chloe, and Dan?_ 
Create a numeric vector called "age" and add their ages to the vector. You can decide their ages.
    ```{r}
    age <- c(35,22,50,51)
    ```
--

3. Use the `class()` function to check the data type of the `name` and `age` vectors.
    ```{r}
    class(name)
    class(age)
    ```

---
# Answers to exercise 2 (continued)

4. _What is their average age?_ 
Use a function in R to calculate this. 
**Tip:** use the Maths Functions section of the Base R cheat sheet!
    ```{r}
    mean(age)
    ```

---
class: subheader, middle, center
# Data structures

---

# Data structures: vector

#### We have two vectors: `name` and `age`
```{r}
name
age
```

How do we combine them?

--

#### Into a one-dimensional vector: `c()`
```{r}
c(name,age)
```

---

# Data structures: data frame

How about combining `name` and `age` in a two-dimensional table structure?

```{r}
data.frame(name,age)
```

Two dimensions:

- Rows
- Columns

---

# Data structures: list

Or: in a multi-dimensional list.

```{r}
list(name,age)
```

Dimensions: any

Lists can contain *any* R object. 
Not just dataframes and vectors, but also other lists.

---
# Data structures: summary

&nbsp;

| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | number of dimensions  | &nbsp; function &nbsp; |
|---:|:---:|:---|
| vector | 1 | &nbsp; &nbsp; `c()` |
| data frame | 2 | &nbsp; &nbsp; `data.frame()`  |
| list | any number | &nbsp; &nbsp; `list()` |

NB: dataframes and lists appear under `Data` in the Environment (top right panel in RStudio), vectors under `Values`.

---
# Factors

#### Special type of vector, defined by _levels_. Usually as categorical variable in a data frame.

--

```{r}
# Create vector country
country <- c("UK","USA","USA","UK")
country

# Turn country into a factor
country_fac <- as.factor(country)
country_fac
```

--

.pull-left[
```{r}
df <- data.frame(name, age, country_fac)
df
```
]
.pull-right[
```{r}
summary(df)
```

]

---
class: subheader, middle, center
# Go to exercise 3

---
# Answers to exercise 3

1. Create a vector called "country" containing four countries of your choice.
    ```{r}
    country <- c("UK", "US", "NL", "BE")
    ```
--

2. Create a data frame called "df" combining name, age, and country.
    ```{r}
    df <- data.frame(name, age, country)
    ```
--

3. Create a list called "mylist" with the 3 vectors and 1 dataframe you have just created. 
    ```{r}
    mylist <- list(name, age, country, df)
    ```

---
class: subheader, middle, center
# Indexing vectors & lists

---
# Selecting vector elements

.pull-left[
![position](images/vector_elements_position.png)
]

--

.pull-right[
![value](images/vector_elements_value.png)
]

---
class: subheader, middle, center
# Go to exercise 4

---
# Answers to exercise 4

1. Return only the first number in your vector `age`.
    ```{r}
    age[1]
    ```
--

2. Return the 2nd and 4th name in your vector `name`.
    ```{r}
    name[c(2,4)]
    ```
--

3. Return only ages under 30 from your vector `age`.
    ```{r}
    age[age<30]
    ```


---
class: subheader, middle, center
# Indexing a data frame

---
# Indexing a data frame

![matrix](images/matrix_subsetting.png)

---
# Indexing columns

By position:
```{r}
df[,2]
```

--

By name (as a character string):
```{r}
df[,"age"]
```

--

By name (as an object):
```{r}
df$age
```

---
# Indexing rows

By position:
```{r}
df[2,]
```

--

By content:
```{r}
df[df$name=="Bob",]
```

--

#### Combining rows and columns
```{r}
df[df$name=="Bob","age"]
```
---
class: subheader, middle, center
# Go to exercise 5

---
# Answers to exercise 5

1. From your dataframe `df`, return complete rows for everyone living in a country of your choice.
    ```{r}
    df[df$country=="UK", ]
    ```
--

2. Return only the names of everyone in your data frame `df` under 40. 
    ```{r}
    df[df$age<40, "name"]
    ```
--

3. Return the columns `name` and `age` together.
    ```{r}
    df[, c("name","age")]
    ```

---

# Selecting from a list

.pull-left[
Selecting a list element from `mylist`:

```{r}
mylist[1]
```

Selecting the *content* of a list element:

```{r}
mylist[[1]]
```

]
--

.pull-right[

Subselection *in the content* of a list element:

```{r}
mylist[[4]][2]
mylist[[4]][1,2]
```
]
---

class: subheader, middle, center
# Missing data

---
# Not Available (NA)

Let's add a column to our data:
```{r}
df$pet <- c("cat","none","",NA)

df
```

--

Notice that:

- we know that Bob has no pets. 
- we do not know if Dan has pets.
- the value for Chloe is empty.

---
# Predict the answer (see Exercise 6)

```r
5 == 5
```
--
```{r echo = F}
5 == 5
```
--
```r
5 == NA
```
--
```{r echo = F}
5 == NA
```
--

```r
NA == NA
```
--
```{r echo = F}
NA == NA
```
--

```r
is.na(NA)
```
--
```{r echo=F}
is.na(NA)
```

--

**So: want to test if a value is NA? Use `is.na()`!**

---
# NULL: data does not exist

Do we know about our participants' jobs?

```{r}
# Select the column "job" from df
df$job
```

--

| | |
|---:|:---|
| `NA` | Information is **N**ot **A**vailable |
| `NULL` | Information does not exist |
| `none` or `0` | Data entry specifying content of 0 |
| `""` | Empty character value |

---

class: subheader, middle, center
# Programming: if statements

---
# If statement: a conditional

An if statement tests if a condition is TRUE or FALSE and exectues code depending on the outcome of that test.

![](images/ifstatement.png)

---
# If statement in R

- To build an if-statement, start with the function `if()`:
  ```r
  if()
  ```
--

- Within the `()`, insert the condition you want to test for:

  ```r
  if(number > 10)
  ```
--

- Within the `{}`, insert the code that should be executed if the condition is met:

  ```r
  if(number > 10) {
      test_result <- "number is greater than 10"
  }
  ```
--

- You can expand the statement with `else {}` if the condition is **not** met.

  ```r
  if(number > 10) {
      test_result <- "number is greater than 10"
  } else {
      test_result <- "number is not greater than 10"
  }
  ```

---
class: subheader, middle, center
# Go to exercise 7

---
# Answers to exercise 7

Make an if statement that tests if a number is larger than 18. 
Assign the result to the variable `age_category`.

```{r}
number <- 8

if(number >= 18){
  age_category <- "adult"
} else{
  age_category <- "minor"
}

print(age_category)
```

---
class: subheader, middle, center
# Programming: functions

---
# Functions: a sequence

#### Functions consist of (multiple) instruction(s) that form a cohesive unit:
![function](images/function.png)
--

#### A function can be repeated on different inputs:
```{r}
mean(df$age)
mean(1:100)
```

---
# Functions

#### Functions can also be used to make a complex line of code easier to write/read:

You write the function once:
```{r}
find_bobs_age <- function(data){
  bobs_age <- data[data$name == "Bob", "age"]
  return(bobs_age)
}
```

Now, every time you want to find Bob's age you use:
```{r}
find_bobs_age(df)
```

--

#### Functions are the bread and butter of programming!

A good script will consist mostly of functions, with a minimal amount of code that applies the functions.

---
# Functions in R

- To make a function, use the function `function()`:
  ```r
  myFun <- function()
  ```
--
- You assign names to the user's input in the function's arguments:
  ```r
  myFun <- function(arg1, arg2)
  ```
--
- The sequence of operations is in the body of the function (between `{ }`):
  ```{r}
  myFun <- function(arg1, arg2){
      multiplication <- arg1 * arg2 #<<
  }
  ```
--
- The output of the function is placed in a `return` statement:
  ```{r}
  myFun <- function(arg1, arg2){
      multiplication <- arg1 * arg2
      return(multiplication) #<<
  }
  ```
---
# Using your own function

First, run the code with the function itself. It will appear in your environment:

![environment](images/function_environment.png)

--

Now, you can use the function:
```{r}
myFun(3,4)
myFun(90,71)
```

---
class: subheader, middle, center
# Go to exercise 8

---
# Answers to exercise 8

Turn the if-statement from the last exercise into a function. Let the user provide the value for `number`, and return the `age_category`.

```{r}
test_age <- function(number){
  if(number >= 18){
    age_category <- "adult"
  } else{
    age_category <- "minor"
  }
  return(age_category)
}
```

--

```{r}
# Test the function
test_age(20)
test_age(2)
```

---
class: subheader, middle, center
# Programming: loops

---
# A for-loop

- Perform the same action(s) for mutiple inputs at a time
- Input is an object with multiple similar elements (e.g., a vector, row in a dataframe, etc.) that can be iterated over

![forloop](images/forloop.png)
---
# A for-loop in R

- A loop starts with the iterable object (in this case the vector `1:5`), and the temporary name for each item (in this case `a_number`):
  ```r
  for(a_number in 1:5)
  ```
--
- Within `{ }`, you place the instructions:
  ```{r}
  for(a_number in 1:5){
    print(a_number) #<<
  }
  ```

--
Note that `a_number` is 1 in the first iteration of the loop, 2 in the second, etc. It does not exist outside the for loop!

---
class: subheader, middle, center
# Go to exercise 9

---
# Answers to exercise 9

Go over the age column in your dataframe df, and for each age: `print()` the age category using the test_age function from the previous exercise.


```{r}
print(df$age)

for(the_age in df$age){
  test <- test_age(the_age)
  print(test)
}
```

---
class: subheader, middle, center
# Recap "Basics of R"
---
# Which bracket does what?

.left-column[
<br />
## &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`[ ]`
&nbsp; 

## &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`(  )`
&nbsp; 

## &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`{  }`
&nbsp;

]
.right-column[
&nbsp;
### Indexing vectors, lists, dataframes… 
&nbsp;

### Passing arguments to functions
&nbsp;

### Defining content of if-statements, functions, loops, etc.
&nbsp;

]

---
# You can speak R!

#### What data types have you encountered so far?  
`logical`   
`numeric`   
`character`

#### How can data be missing?  
`NA` (not available)  
`NULL` (non-existent)   
`""` (empty)

#### What data structures have you encountered?
`vector` (one dimension)  
`data frame` (two dimensions)  
`list` (++ dimensions)  

---
# Functions

#### What functions have you encountered so far?

`c()`  
`data.frame()`  
`is.na()`  
`mean()`  
`summary()`    
`...`

#### Programming basics

- If-statements
- Functions
- For-loops

---
# Help!

- How does a function work? Type in your console:  
     `?mean`

- Use a search engine (often useful: Stackoverflow)
- (Generative AI)
    - Upside: can write all code for you
    - Downside: you learn less, can hallucinate, not certain what sources it uses

---
# Help!

![help](images/help1.png)

---
# Help? Scroll down for examples!
![help](images/help2.png)

---
# Note on R projects

When you start programming for yourself:

- Create a folder dedicated to your project
- Start a new R project: File > New Project > Existing Directory
- An `.RProj` file will be created

--

Advantages:

- Automatically set your working directory to that folder
- Automatically retrieve only the history and objects from that R project

---
class: subheader, middle, center
# Lunch break!